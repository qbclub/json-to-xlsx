# json-to-xlsx

Простой CLI для конвертации JSON в Excel (xlsx) с поддержкой больших файлов.

## Установка

```bash
npm install
```

## Использование

### Базовое использование

```bash
# конвертирует sample.json -> out.xlsx
node index.js sample.json out.xlsx

# или, если указать только входной файл — создаст out.xlsx
node index.js data.json
```

### Дополнительные опции

```bash
# Показать справку
node index.js --help

# Принудительно использовать потоковую обработку
node index.js --stream large-file.json output.xlsx

# Установить размер пакета для потоковой обработки
node index.js --batch-size=500 data.json result.xlsx
```

## Обработка больших файлов

Программа автоматически определяет большие файлы (>50MB) и переключается на потоковую обработку для экономии памяти. Для больших файлов:

- ✅ Используется минимальное количество оперативной памяти
- ✅ Показывается прогресс обработки
- ✅ Поддерживаются файлы любого размера
- ✅ Настраиваемый размер пакета обработки

## Поддержка форматов JSON

- **Массив объектов** → одна таблица (flatten вложенных объектов, ключи через точку)
- **Объект с массивами** → каждая пара ключ/массив станет отдельным листом
- **Одиночный объект** → одна строка с заголовками (flatten)

## Примечания

- Имена листов обрезаются до 31 символа (ограничение XLSX)
- Пустые поля заполняются пустой строкой
- Большие файлы обрабатываются пакетами по 1000 записей (настраивается)

## Примеры

```bash
# Обычная конвертация
node index.js sample.json out.xlsx

# Большой файл с потоковой обработкой
node index.js --stream huge-data.json result.xlsx

# Настройка размера пакета для оптимизации производительности
node index.js --batch-size=2000 data.json output.xlsx
```

